{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAMMC,EAAU,IAAI,EAAAC,EAAAC,YAEpBC,EAAAC,KAAKC,cAAcC,iBAAiB,U,SAoCRC,G,OAAbC,EAAYC,MAAAC,KAAAC,U,IAnC3BR,EAAAC,KAAKQ,eAAeN,iBAAiB,SAiFrC,WACEN,EAAQa,gBAEHb,EAAQc,iBACXX,EAAAC,KAAKQ,eAAeG,UAAUC,IAAI,mBAClCC,EAAAC,GAASC,OAAOC,KACd,+DAIJpB,EACGqB,YACAC,MAAK,SAAAC,G,IAAGC,EAAID,EAAJC,KACDC,GAAS,EAAAC,EAAAC,cAAaH,GAC5BrB,EAAAC,KAAKwB,QAAQC,mBAAmB,YAAaJ,E,IAE9CK,OAAM,SAAAC,GACLC,QAAQC,IAAIF,GACZG,G,OAjGN,I,EAKMC,G,EAAWlB,EAAAnB,EAAA,CAAAmB,EAAAmB,GAAAC,MAAA,SAAAC,EAAgBC,EAASC,G,kEACxCD,EAAQE,QAAO,W,MAACxB,EAAAnB,EAAA,CAAAmB,EAAAmB,GAAAC,MAAA,SAAAK,EAAMC,G,IAcRnB,EAEFC,E,sEAfNkB,EAAMC,eAAc,C,uBACtBZ,QAAQC,IAAIU,EAAME,kBAClB7C,EAAQa,gBAERiC,EAAGC,UAAUJ,EAAMK,QACdhD,EAAQc,iBACXgC,EAAGC,UAAUJ,EAAMK,QACnB/B,EAAAC,GAASC,OAAOC,KACd,+D,kBAKqBpB,EAAQqB,Y,OAAzBG,EAAMyB,EAAAC,KAAJ1B,KAEFC,GAAS,EAAAC,EAAAC,cAAaH,GAC5BrB,EAAAC,KAAKwB,QAAQC,mBAAmB,YAAaJ,G,kDAE7CO,QAAQC,IAAGgB,EAAAE,IACXjB,I,0EApBgBS,G,gCAAP,I,oDADgBJ,EAASC,G,iCA0BpCM,EAAK,IAAIM,qBAAqBjB,EA/BpB,CACdkB,KAAM,KACNC,WAAY,QACZC,UAAW,I,SA8BE/C,I,OAAAA,EAAfS,EAAAnB,EAAA,CAAAmB,EAAAmB,GAAAC,MAAA,SAAAK,EAA4BnC,G,IAKtBiD,EADUC,EAGRC,EAUoBC,EAAhBnC,EAAMoC,EAORnC,EAYEuB,E,qEAnCVzC,EAAIsD,iBAIAL,EAAAjD,EAAIuD,cADNL,EACED,EADFO,SAAYN,YAGRC,EAAQD,EAAYO,MAAMC,OAAOC,cAC7B,C,uDAIVlE,EAAQyD,YAAcC,EACtBxB,IACA/B,EAAAC,KAAKQ,eAAeG,UAAUC,IAAI,mB,mBAGFhB,EAAQqB,Y,WAAdsC,EAAyBV,EAAAC,KAAzC1B,EAAgBmC,EAAhBnC,KAAMoC,EAAUD,EAAVC,MACM,IAAhBpC,EAAK2C,OAAY,C,uBACnBlD,EAAAC,GAASC,OAAOiD,QACd,4E,2BAIE3C,GAAS,EAAAC,EAAAC,cAAaH,GAC5BrB,EAAAC,KAAKwB,QAAQC,mBAAmB,YAAaJ,GAE7CzB,EAAQqE,oBAAoBT,GAC5B3C,EAAAC,GAASC,OAAOmD,QAAQ,oBAA0BC,OAANX,EAAM,YAAW,CAC3DY,QAAS,IACTC,SAAU,aAIRzE,EAAQc,iBAEJkC,EAAS0B,SAASC,cAAc,0BACtC3C,QAAQC,IAAIe,GACZF,EAAG8B,QAAQ5B,I,kDAGbhB,QAAQC,IAAGgB,EAAAE,IACXjB,I,2DA1CuBzB,MAAAC,KAAAC,U,CAoE3B,SAASuB,IACPlC,EAAQ6E,YACR1E,EAAAC,KAAKwB,QAAQkD,UAAY,E","sources":["src/infinite-scroll.js"],"sourcesContent":["import './css/styles.css';\nimport { PixabayAPI } from './PixabayAPI';\nimport { createMarkup } from './createMarkup';\nimport { refs } from './refs';\nimport Notiflix from 'notiflix';\n\nconst pixabay = new PixabayAPI();\n\nrefs.searchFormRef.addEventListener('submit', handleSubmit);\nrefs.loadMoreBtnRef.addEventListener('click', onLoadMoreClick);\n\nconst options = {\n  root: null,\n  rootMargin: '100px',\n  threshold: 1.0,\n};\nconst callback = async function (entries, observer) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      console.log(entry.intersectionRect);\n      pixabay.incrementPage();\n      //   console.log(pixabay);\n      io.unobserve(entry.target);\n      if (!pixabay.isShowLoadMore) {\n        io.unobserve(entry.target);\n        Notiflix.Notify.info(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n\n      try {\n        const { hits } = await pixabay.getPhotos();\n\n        const markup = createMarkup(hits);\n        refs.listRef.insertAdjacentHTML('beforeend', markup);\n      } catch (error) {\n        console.log(error);\n        clearPage();\n      }\n    }\n  });\n};\nconst io = new IntersectionObserver(callback, options);\n\nasync function handleSubmit(evt) {\n  evt.preventDefault();\n\n  const {\n    elements: { searchQuery },\n  } = evt.currentTarget;\n\n  const query = searchQuery.value.trim().toLowerCase();\n  if (!query) {\n    return;\n  }\n\n  pixabay.searchQuery = query;\n  clearPage();\n  refs.loadMoreBtnRef.classList.add('visually-hidden');\n\n  try {\n    const { hits, total } = await pixabay.getPhotos();\n    if (hits.length === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n    const markup = createMarkup(hits);\n    refs.listRef.insertAdjacentHTML('beforeend', markup);\n\n    pixabay.calculateTotalPages(total);\n    Notiflix.Notify.success(`Hooray! We found ${total} images.`, {\n      timeout: 1000,\n      position: 'left-top',\n    });\n    // console.log(pixabay);\n\n    if (pixabay.isShowLoadMore) {\n      //   refs.loadMoreBtnRef.classList.remove('visually-hidden');\n      const target = document.querySelector('.photo-card:last-child');\n      console.log(target);\n      io.observe(target);\n    }\n  } catch (error) {\n    console.log(error);\n    clearPage();\n  }\n}\n\nfunction onLoadMoreClick() {\n  pixabay.incrementPage();\n\n  if (!pixabay.isShowLoadMore) {\n    refs.loadMoreBtnRef.classList.add('visually-hidden');\n    Notiflix.Notify.info(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  }\n\n  pixabay\n    .getPhotos()\n    .then(({ hits }) => {\n      const markup = createMarkup(hits);\n      refs.listRef.insertAdjacentHTML('beforeend', markup);\n    })\n    .catch(error => {\n      console.log(error);\n      clearPage();\n    });\n}\n\nfunction clearPage() {\n  pixabay.resetPage();\n  refs.listRef.innerHTML = '';\n}\n"],"names":["$bpxeT","parcelRequire","$197be06ee8836f34$var$pixabay","$evVGa","PixabayAPI","$foHtm","refs","searchFormRef","addEventListener","evt","$197be06ee8836f34$var$_handleSubmit","apply","this","arguments","loadMoreBtnRef","incrementPage","isShowLoadMore","classList","add","$parcel$interopDefault","$iU1Pc","Notify","info","getPhotos","then","param","hits","markup","$uIGk8","createMarkup","listRef","insertAdjacentHTML","catch","error","console","log","$197be06ee8836f34$var$clearPage","$197be06ee8836f34$var$callback","$2TvXO","mark","_callee1","entries","observer","forEach","_callee","entry","isIntersecting","intersectionRect","$197be06ee8836f34$var$io","unobserve","target","_ctx","sent","t0","IntersectionObserver","root","rootMargin","threshold","_currentTarget","searchQuery","query","ref","total","preventDefault","currentTarget","elements","value","trim","toLowerCase","length","failure","calculateTotalPages","success","concat","timeout","position","document","querySelector","observe","resetPage","innerHTML"],"version":3,"file":"infinite-scroll.a3cd1280.js.map"}